<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Payment Success</title>
	</head>

	<body>
		<h1>You paid!</h1>
		<p>Congratulations. Now I have all of your money.</p>

		<p>Here is your secret bonus content!:</p>
		<span>bark</span>

		<script>
			const params = new URLSearchParams(window.location.search);
			const paymentSessionId = params.get('payment_session_id');

			if (paymentSessionId) {
				localStorage.setItem('payment_session_id', paymentSessionId);

				fetch(`http://localhost:3000/verify?payment_session_id=${paymentSessionId}`)
					.then(res => res.json())
					.then((data) => {
						if (data.hasPaid) {
							localStorage.setItem('has_paid', data.hasPaid);
						}
					});
			}
		</script>
	</body>
</html>
